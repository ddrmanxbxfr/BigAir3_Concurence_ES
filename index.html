<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BigR³ | Concurrence recherche</title>
    <link rel="stylesheet" href="css/foundation.css" />
    <script src="js/vendor/modernizr.js"></script>
  </head>
  <body>
        <!-- Nav Bar -->
 
  <div class="row">
    <div class="large-12 columns">
      <div class="nav-bar right">
       <ul class="button-group">
         <li><a id="btnStart" href="#" class="button">Démarer les requêtes</a></li>
         <li><a id="btnStop" href="#" class="button">Arrêter</a></li>
	</ul>
      </div>
      <h1>Démo concurence <br /><small>Des recherches massives</small></h1>
      <hr />
    </div>
  </div>
 
  <!-- End Nav -->
 
 
  <!-- Main Page Content and Sidebar -->
 
  <div class="row">
 
    <!-- Main Blog Content -->
    <div class="large-9 columns" role="content">
        <h3><a href="#">Liste des utilisateurs bidon</a></h3> 
      <article id="domUserBidon">	
      </article> 
    </div>
 
    <!-- End Main Content --> 
  <!-- End Main Content and Sidebar -->
 
 
  <!-- Footer -->
 
  <footer class="row">
    <div class="large-12 columns">
      <hr />
      <div class="row">
        <div class="large-6 columns">
          <p>Réalisé par l'équipe BigR³.</p>
        </div>
        <div class="large-6 columns">
        </div>
      </div>
    </div>
  </footer>

    <script src="js/vendor/jquery.js"></script>
    <script src="js/foundation.min.js"></script>
    <script>
      $(document).foundation();
    </script>

<!-- Code du demo !!! -->
	<script>
	var runInterval;
	var nbWorker = 0;
		<!-- Event de démarage des threads !!! -->
		$( "#btnStart" ).click(function() {
			//startWebWorker();
			runStatus = true;
			startEventedWebWorker();
		});

		$("#btnStop").click(function() {
			generateDomClientBidon();
			//window.clearInterval(runInterval);
		});

		function generateDomClientBidon() {
		var domUsers = document.getElementById("domUserBidon");
		// Ceci ajoute un row de users
		for (var i = 0; i < 9; i++) {
			var row = document.createElement("div");
		row.className="row";
		for (var j = 0; j < 6; j++) {
			nbWorker = nbWorker + 1;
			var cls1 = document.createElement("div");
			cls1.className="small-2 columns text-center";
			row.appendChild(cls1);
			var img = document.createElement("img");
			img.src="img/user.png";
			cls1.appendChild(img);
			var p = document.createElement("p");
			p.id ="worker" + nbWorker;
			cls1.appendChild(p);
		}
		domUsers.appendChild(row);
			}

		};


		function startEventedWebWorker(){
		//HTML5 Web Workers

		var worker = new Worker('worker_event.js');
		
		worker.addEventListener('message', function(e) {
		 // console.log('temp execution: ', e.data);
		  document.getElementById("worker1").textContent = e.data + "ms";
		}, false);
		
		runInterval = setInterval(function() {
		worker.postMessage('http://cirq.codingrhemes.com:9200/_search'); // Send filename to our worker.
			}, 5000);
		};


		// Exécuter la génération des DOM
		generateDomClientBidon();
	</script>
  </body>
</html>
